import{a as i,f as l,t as Ut}from"../chunks/BQbrFHdE.js";import{o as Dt}from"../chunks/DKpGyjba.js";import{p as Et,o as R,G as xt,a as Gt,g as t,m as _,h as Jt,s as a,i as r,j as e,q as Z,t as C,n as G,k as V}from"../chunks/DEIXV2yr.js";import{d as Tt,s as x,a as Vt}from"../chunks/Bv3bKQ8S.js";import{i as A}from"../chunks/BKTWmeyc.js";import{e as it,i as ft}from"../chunks/Bgl9SafJ.js";import{s as mt}from"../chunks/Bx2xMsXF.js";import{s as ot,c as qt}from"../chunks/QSA7lv9p.js";import{s as Ft}from"../chunks/CH4Gho_O.js";import{b as Kt}from"../chunks/DkV04bLW.js";import{a as J}from"../chunks/CowlEwwk.js";import{H as Wt,C as q}from"../chunks/ARQSVmb3.js";import{S as Q}from"../chunks/CkPAyeN2.js";import{B as Yt}from"../chunks/EGcPkOJ4.js";import{S as _t}from"../chunks/2BnSfrOL.js";var Zt=l('<div class="flex items-center justify-center py-20"><!></div>'),Qt=l('<div class="text-center py-12"><p class="text-zinc-400 text-sm">No projects found. Connect Muninn to see your monthly report.</p></div>'),Xt=l("<option> </option>"),te=l('<div class="flex items-center justify-center py-16"><!></div>'),ee=l('<div class="flex items-center gap-2"><span class="text-xs text-zinc-500 w-28 truncate"> </span> <div class="flex-1 h-1.5 bg-zinc-800 rounded-full overflow-hidden"><div></div></div> <span class="text-xs text-zinc-400 w-8 text-right"> </span></div>'),re=l('<div class="relative w-24 h-24 shrink-0"><svg class="w-24 h-24 -rotate-90" viewBox="0 0 36 36"><circle cx="18" cy="18" r="15.9" fill="none" stroke-width="2" class="stroke-zinc-800"></circle><circle cx="18" cy="18" r="15.9" fill="none" stroke-width="2" stroke-linecap="round"></circle></svg> <span> </span></div> <div class="flex-1 space-y-2"><h3 class="text-sm font-medium text-zinc-200">Health Score</h3> <!></div>',1),se=l('<div class="text-center py-4 w-full"><p class="text-zinc-500 text-sm">No health score computed yet.</p></div>'),ae=l('<div class="flex items-center gap-6"><!></div>'),ie=l('<div class="grid grid-cols-2 gap-4"><div><p class="text-2xl font-bold text-cyan-400"> </p> <p class="text-xs text-zinc-500">Files Tracked</p></div> <div><p class="text-2xl font-bold text-violet-400"> </p> <p class="text-xs text-zinc-500">Decisions</p></div> <div><p class="text-2xl font-bold text-emerald-400"> </p> <p class="text-xs text-zinc-500">Learnings</p></div> <div><p class="text-2xl font-bold text-red-400"> </p> <p class="text-xs text-zinc-500">Issues</p></div></div>'),oe=l('<p class="text-zinc-500 text-sm">No memory data available.</p>'),le=l('<h3 class="text-sm font-medium text-zinc-200 mb-4">Knowledge Inventory</h3> <!>',1),ne=l('<div><h3 class="text-sm font-medium text-zinc-300 mb-3">Context ROI â€” This Month</h3> <div class="grid grid-cols-2 md:grid-cols-4 gap-4"><!> <!> <!> <!></div></div>'),ve=l('<div class="flex items-center gap-3 py-2"><svg class="w-5 h-5 text-emerald-400 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path></svg> <span class="text-sm text-zinc-400">No active risk alerts. Your project is looking healthy.</span></div>'),de=l('<p class="text-xs text-zinc-500 mt-1 line-clamp-2"> </p>'),ce=l('<p class="text-xs text-zinc-600 mt-1 font-mono"> </p>'),ue=l('<div class="flex items-start gap-3"><!> <div class="flex-1 min-w-0"><p class="text-sm text-zinc-200"> </p> <!> <!></div></div>'),pe=l('<div class="space-y-2"></div>'),xe=l(`<div class="border-b border-zinc-800 pb-4"><h2 class="text-xl font-semibold text-white"> </h2> <p class="text-sm text-zinc-500 mt-1">Generated from your project's memory data</p></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><!> <!></div> <!> <div><h3 class="text-sm font-medium text-zinc-300 mb-3">Active Risk Alerts</h3> <!></div>`,1),fe=l('<div class="flex flex-col sm:flex-row gap-4 items-start sm:items-end justify-between"><div><label for="report-project" class="block text-sm font-medium text-zinc-300 mb-1.5">Project</label> <select id="report-project" class="w-full max-w-sm bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"></select></div> <button class="px-4 py-2.5 bg-zinc-800 border border-zinc-700 rounded-lg text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed"> </button></div> <!>',1),me=l('<div class="max-w-5xl space-y-6"><!> <!></div>');function Le(gt,ht){Et(ht,!0);let T=R(xt([])),M=R(null),H=R(null),I=R(null),X=R(xt([])),B=R(null),lt=R(!0),tt=R(!1),F=R(!1);const bt=V(()=>new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"}));Dt(async()=>{try{const s=await J.getProjects();_(T,s.projects,!0),t(T).length>0&&_(M,t(T)[0].id,!0)}catch{}_(lt,!1)}),Gt(()=>{const s=t(M);s!==null&&(_(tt,!0),Promise.all([J.getHealthScore(s).catch(()=>null),J.getRoiMetrics(s).catch(()=>null),J.getRiskAlerts(s).catch(()=>({alerts:[]})),J.getProjectMemory(s).catch(()=>null)]).then(([m,g,f,P])=>{_(H,m,!0),_(I,g,!0),_(X,(f==null?void 0:f.alerts)??[],!0),_(B,P?{files:P.files.length,decisions:P.decisions.length,learnings:P.learnings.length,issues:P.issues.length}:null,!0)}).finally(()=>{_(tt,!1)}))});async function yt(){if(t(M)){_(F,!0);try{const s=await J.exportMemory(t(M)),m=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),g=URL.createObjectURL(m),f=document.createElement("a");f.href=g,f.download=`muninn-export-${t(M)}-${new Date().toISOString().slice(0,10)}.json`,f.click(),URL.revokeObjectURL(g)}catch{}_(F,!1)}}function wt(s){return s>=80?"text-emerald-400":s>=60?"text-amber-400":"text-red-400"}function zt(s){return s>=80?"stroke-emerald-400":s>=60?"stroke-amber-400":"stroke-red-400"}function kt(s){return s==="critical"?"danger":s==="warning"?"warning":"default"}var et=me(),nt=r(et);Wt(nt,{title:"Monthly Value Report",description:"See what Muninn has done for your project this month."});var $t=a(nt,2);{var jt=s=>{var m=Zt(),g=r(m);_t(g,{size:"lg"}),e(m),i(s,m)},St=s=>{q(s,{children:(m,g)=>{var f=Qt();i(m,f)},$$slots:{default:!0}})},Ct=s=>{var m=fe(),g=Z(m),f=r(g),P=a(r(f),2);it(P,21,()=>t(T),ft,(w,z)=>{var h=Xt(),W=r(h,!0);e(h);var Y={};C(()=>{x(W,t(z).name),Y!==(Y=t(z).id)&&(h.value=(h.__value=t(z).id)??"")}),i(w,h)}),e(P),e(f);var K=a(f,2),Pt=r(K,!0);e(K),e(g);var Rt=a(g,2);{var Mt=w=>{var z=te(),h=r(z);_t(h,{}),e(z),i(w,z)},Lt=w=>{var z=xe(),h=Z(z),W=r(h),Y=r(W);e(W),G(2),e(h);var rt=a(h,2),vt=r(rt);q(vt,{children:(u,b)=>{var p=ae(),d=r(p);{var L=n=>{var v=re(),k=Z(v),$=r(k),U=a(r($));e($);var j=a($,2),D=r(j,!0);e(j),e(k);var E=a(k,2),O=a(r(E),2);it(O,17,()=>t(H).components,ft,(c,o)=>{var y=ee(),S=r(y),st=r(S,!0);e(S);var at=a(S,2),ut=r(at);e(at);var pt=a(at,2),Bt=r(pt,!0);e(pt),e(y),C(()=>{mt(S,"title",t(o).name),x(st,t(o).name),ot(ut,1,`h-full rounded-full ${t(o).score>=80?"bg-emerald-400":t(o).score>=60?"bg-amber-400":"bg-red-400"}`),Ft(ut,`width: ${t(o).score??""}%`),x(Bt,t(o).score)}),i(c,y)}),e(E),C((c,o)=>{ot(U,0,c),mt(U,"stroke-dasharray",`${t(H).overall??""}, 100`),ot(j,1,`absolute inset-0 flex items-center justify-center text-2xl font-bold ${o??""}`),x(D,t(H).overall)},[()=>qt(zt(t(H).overall)),()=>wt(t(H).overall)]),i(n,v)},N=n=>{var v=se();i(n,v)};A(d,n=>{t(H)?n(L):n(N,!1)})}e(p),i(u,p)},$$slots:{default:!0}});var At=a(vt,2);q(At,{children:(u,b)=>{var p=le(),d=a(Z(p),2);{var L=n=>{var v=ie(),k=r(v),$=r(k),U=r($,!0);e($),G(2),e(k);var j=a(k,2),D=r(j),E=r(D,!0);e(D),G(2),e(j);var O=a(j,2),c=r(O),o=r(c,!0);e(c),G(2),e(O);var y=a(O,2),S=r(y),st=r(S,!0);e(S),G(2),e(y),e(v),C(()=>{x(U,t(B).files),x(E,t(B).decisions),x(o,t(B).learnings),x(st,t(B).issues)}),i(n,v)},N=n=>{var v=oe();i(n,v)};A(d,n=>{t(B)?n(L):n(N,!1)})}i(u,p)},$$slots:{default:!0}}),e(rt);var dt=a(rt,2);{var Ht=u=>{var b=ne(),p=a(r(b),2),d=r(p);{let v=V(()=>String(t(I).contradictionsPrevented));Q(d,{label:"Contradictions Prevented",get value(){return t(v)},subtitle:"Caught before commit"})}var L=a(d,2);{let v=V(()=>Math.round(t(I).contextHitRate*100));Q(L,{label:"Context Hit Rate",get value(){return`${t(v)??""}%`},subtitle:"Predictions used"})}var N=a(L,2);{let v=V(()=>String(t(I).learningsApplied));Q(N,{label:"Learnings Applied",get value(){return t(v)},subtitle:"Reused knowledge"})}var n=a(N,2);Q(n,{label:"Sessions with Context",get value(){return`${t(I).sessionsWithContext??""}/${t(I).totalSessions??""}`},subtitle:"Context-assisted"}),e(p),e(b),i(u,b)};A(dt,u=>{t(I)&&u(Ht)})}var ct=a(dt,2),It=a(r(ct),2);{var Nt=u=>{q(u,{children:(b,p)=>{var d=ve();i(b,d)},$$slots:{default:!0}})},Ot=u=>{var b=pe();it(b,21,()=>t(X),p=>p.id,(p,d)=>{q(p,{children:(L,N)=>{var n=ue(),v=r(n);{let c=V(()=>kt(t(d).severity));Yt(v,{get variant(){return t(c)},children:(o,y)=>{G();var S=Ut();C(()=>x(S,t(d).severity)),i(o,S)},$$slots:{default:!0}})}var k=a(v,2),$=r(k),U=r($,!0);e($);var j=a($,2);{var D=c=>{var o=de(),y=r(o,!0);e(o),C(()=>x(y,t(d).details)),i(c,o)};A(j,c=>{t(d).details&&c(D)})}var E=a(j,2);{var O=c=>{var o=ce(),y=r(o,!0);e(o),C(()=>x(y,t(d).source_file)),i(c,o)};A(E,c=>{t(d).source_file&&c(O)})}e(k),e(n),C(()=>x(U,t(d).title)),i(L,n)},$$slots:{default:!0}})}),e(b),i(u,b)};A(It,u=>{t(X).length===0?u(Nt):u(Ot,!1)})}e(ct),C(()=>x(Y,`${t(bt)??""} Report`)),i(w,z)};A(Rt,w=>{t(tt)?w(Mt):w(Lt,!1)})}C(()=>{K.disabled=t(F)||!t(M),x(Pt,t(F)?"Exporting...":"Export Memory JSON")}),Kt(P,()=>t(M),w=>_(M,w)),Vt("click",K,yt),i(s,m)};A($t,s=>{t(lt)?s(jt):t(T).length===0?s(St,1):s(Ct,!1)})}e(et),i(gt,et),Jt()}Tt(["click"]);export{Le as component};
