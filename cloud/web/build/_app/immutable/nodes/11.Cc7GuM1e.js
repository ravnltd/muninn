import{a as i,f,t as K,c as te}from"../chunks/Dp4zGy6Y.js";import{o as re}from"../chunks/D1MHOrrt.js";import{p as ae,m as _,G as oe,o as g,h as se,s,k as n,g as t,j as v,l as m,n as h,t as D,F as ne}from"../chunks/BJmdqduM.js";import{d as le,e as ie,s as k,a as de}from"../chunks/9hSCU5Uy.js";import{i as E}from"../chunks/eWemM8hH.js";import{e as ce,i as ve}from"../chunks/DQGcvq5X.js";import{a as M,A as G}from"../chunks/CObeKhF_.js";import{a as me}from"../chunks/Cbs5zNOM.js";import{H as pe,C as q}from"../chunks/Do8S-cRJ.js";import{D as ue}from"../chunks/Dbe2GJk8.js";import{B as C}from"../chunks/C46VhHkI.js";import{I as fe}from"../chunks/D_U8r58x.js";import{M as xe}from"../chunks/CQF6rH2y.js";import{C as ye}from"../chunks/C-eedgcY.js";var _e=f('<div class="bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg text-sm"> </div>'),$e=f(`<h3 class="font-semibold mb-2">Key created</h3> <p class="text-sm text-zinc-400 mb-3">Copy this key now — you won't see it again.</p> <!> <div class="mt-3"><!></div>`,1),ge=f('<h3 class="font-semibold mb-4">Create new key</h3> <form class="flex gap-3"><div class="flex-1"><!></div> <!></form>',1),he=f('<tr><td class="px-6 py-3 text-zinc-300"> </td><td class="px-6 py-3 font-mono text-sm text-zinc-400"> </td><td class="px-6 py-3 text-zinc-400"> </td><td class="px-6 py-3 text-right"><button class="text-sm text-red-400 hover:text-red-300">Revoke</button></td></tr>'),ke=f('<tr><td colspan="4" class="px-6 py-8 text-center text-zinc-500">No API keys yet</td></tr>'),be=f("<!> <!>",1),Pe=f(`<p class="text-sm text-zinc-400">Are you sure you want to revoke <span class="text-zinc-200 font-mono"> </span>?
    Any applications using this key will lose access immediately.</p>`),we=f('<div class="max-w-4xl space-y-8"><!> <!> <!> <!> <!></div> <!>',1);function Ee(J,L){ae(L,!0);let B=_(oe([])),b=_(""),P=_(!1),w=_(null),u=_(null),$=_("");re(A);async function A(){try{const e=await M.getKeys();n(B,e.keys,!0)}catch{}}async function O(){n(P,!0),n($,"");try{const e=await M.createKey(t(b)||void 0);n(w,e,!0),n(b,""),await A()}catch(e){n($,e instanceof G?e.message:"Failed to create key",!0)}finally{n(P,!1)}}async function Q(){if(t(u))try{await M.revokeKey(t(u).id),n(u,null),await A()}catch(e){n($,e instanceof G?e.message:"Failed to revoke key",!0)}}var F=we(),z=g(F),N=v(z);pe(N,{title:"API Keys",description:"Create and manage API keys for accessing Muninn."});var R=s(N,2);{var S=e=>{var p=_e(),d=v(p,!0);m(p),D(()=>k(d,t($))),i(e,p)};E(R,e=>{t($)&&e(S)})}var T=s(R,2);{var U=e=>{q(e,{children:(p,d)=>{var c=$e(),r=s(g(c),4);ye(r,{get code(){return t(w).key}});var a=s(r,2),l=v(a);C(l,{size:"sm",variant:"secondary",onclick:()=>{n(w,null)},children:(o,x)=>{h();var y=K("Done");i(o,y)},$$slots:{default:!0}}),m(a),i(p,c)},$$slots:{default:!0}})};E(T,e=>{t(w)&&e(U)})}var H=s(T,2);q(H,{children:(e,p)=>{var d=ge(),c=s(g(d),2),r=v(c),a=v(r);fe(a,{placeholder:"Key name (optional)",get value(){return t(b)},set value(o){n(b,o,!0)}}),m(r);var l=s(r,2);C(l,{type:"submit",get loading(){return t(P)},get disabled(){return t(P)},children:(o,x)=>{h();var y=K("Create");i(o,y)},$$slots:{default:!0}}),m(c),ie("submit",c,o=>{o.preventDefault(),O()}),i(e,d)},$$slots:{default:!0}});var V=s(H,2);ue(V,{columns:["Name","Prefix","Created",""],children:(e,p)=>{var d=te(),c=g(d);ce(c,17,()=>t(B),ve,(r,a)=>{var l=he(),o=v(l),x=v(o,!0);m(o);var y=s(o),X=v(y);m(y);var I=s(y),Y=v(I,!0);m(I);var j=s(I),Z=v(j);m(j),m(l),D(ee=>{k(x,t(a).name??"—"),k(X,`${t(a).prefix??""}...`),k(Y,ee)},[()=>me(t(a).createdAt)]),de("click",Z,()=>{n(u,t(a),!0)}),i(r,l)},r=>{var a=ke();i(r,a)}),i(e,d)},$$slots:{default:!0}}),m(z);var W=s(z,2);{const e=d=>{var c=be(),r=g(c);C(r,{variant:"secondary",onclick:()=>{n(u,null)},children:(l,o)=>{h();var x=K("Cancel");i(l,x)},$$slots:{default:!0}});var a=s(r,2);C(a,{variant:"danger",onclick:Q,children:(l,o)=>{h();var x=K("Revoke");i(l,x)},$$slots:{default:!0}}),i(d,c)};let p=ne(()=>t(u)!==null);xe(W,{get open(){return t(p)},onclose:()=>{n(u,null)},title:"Revoke API key",actions:e,children:(d,c)=>{var r=Pe(),a=s(v(r)),l=v(a);m(a),h(),m(r),D(()=>{var o;return k(l,`${((o=t(u))==null?void 0:o.prefix)??""}...`)}),i(d,r)},$$slots:{actions:!0,default:!0}})}i(J,F),se()}le(["click"]);export{Ee as component};
