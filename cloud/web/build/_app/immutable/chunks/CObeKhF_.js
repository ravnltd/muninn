const d="https://api.muninn.pro";class r extends Error{constructor(o,a){super(a),this.status=o,this.name="ApiError"}}function c(){return localStorage.getItem("muninn_api_key")}function p(t){localStorage.setItem("muninn_api_key",t)}function m(){localStorage.removeItem("muninn_api_key")}async function e(t,o={}){const a=c(),n={"Content-Type":"application/json",...o.headers??{}};a&&(n.Authorization=`Bearer ${a}`);const i=await fetch(`${d}${t}`,{...o,headers:n});if(i.status===401)throw m(),window.location.href="/login",new r(401,"Unauthorized");if(!i.ok){const s=await i.json().catch(()=>({error:i.statusText}));throw new r(i.status,s.error??s.message??i.statusText)}if(i.status!==204)return i.json()}const u={async signup(t,o,a){const n=await e("/api/signup",{method:"POST",body:JSON.stringify({email:t,password:o,name:a})});return p(n.apiKey),n},async login(t,o){const a=await e("/api/login",{method:"POST",body:JSON.stringify({email:t,password:o})});return p(a.apiKey),a},logout(){m(),window.location.href="/login"},isAuthenticated(){return c()!==null},getAccount:()=>e("/api/account"),deleteAccount:()=>e("/api/account",{method:"DELETE"}),deleteData:()=>e("/api/delete-my-data",{method:"POST"}),exportData:()=>e("/api/export"),getKeys:()=>e("/api/keys"),createKey:t=>e("/api/keys",{method:"POST",body:JSON.stringify({name:t})}),revokeKey:t=>e(`/api/keys/${t}`,{method:"DELETE"}),getUsage:()=>e("/api/usage"),getMembers:()=>e("/api/team/members"),inviteMember:(t,o)=>e("/api/team/invite",{method:"POST",body:JSON.stringify({email:t,role:o})}),updateMemberRole:(t,o)=>e(`/api/team/members/${t}`,{method:"PATCH",body:JSON.stringify({role:o})}),removeMember:t=>e(`/api/team/members/${t}`,{method:"DELETE"}),getInvitations:()=>e("/api/team/invitations"),revokeInvitation:t=>e(`/api/team/invitations/${t}`,{method:"DELETE"}),createCheckout:()=>e("/api/billing/checkout",{method:"POST",body:JSON.stringify({plan:"pro"})}),openPortal:()=>e("/api/billing/portal",{method:"POST"}),setDatabase:(t,o)=>e("/api/database",{method:"PUT",body:JSON.stringify({tursoDbUrl:t,tursoAuthToken:o})}),getSsoConfig:()=>e("/api/sso/config"),updateSsoConfig:t=>e("/api/sso/config",{method:"PUT",body:JSON.stringify(t)}),deleteSsoConfig:()=>e("/api/sso/config",{method:"DELETE"}),testSso:()=>e("/api/sso/test",{method:"POST"})};export{r as A,u as a};
