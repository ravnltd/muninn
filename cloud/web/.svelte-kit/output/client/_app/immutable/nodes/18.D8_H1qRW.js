import{a as d,f as g,t as y}from"../chunks/BQbrFHdE.js";import{o as ge}from"../chunks/DKpGyjba.js";import{p as he,q as k,h as _e,s as o,i as c,t as A,m as t,g as e,k as F,o as p,j as u,n as w}from"../chunks/DEIXV2yr.js";import{e as le,s as $}from"../chunks/Bv3bKQ8S.js";import{i as Q}from"../chunks/BKTWmeyc.js";import{a as D,A as H}from"../chunks/CowlEwwk.js";import{g as xe}from"../chunks/GlkoDLOJ.js";import{H as $e,C as N}from"../chunks/ARQSVmb3.js";import{B as E}from"../chunks/BuIY9Rip.js";import{I as M}from"../chunks/Cuev1EoJ.js";import{M as ye}from"../chunks/CrH9WQjl.js";import"../chunks/CxuafFRJ.js";var ke=g('<div class="bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg text-sm"> </div>'),we=g('<h3 class="font-semibold mb-4">Account</h3> <div class="space-y-3 text-sm"><div class="flex items-center justify-between"><span class="text-zinc-400">Email</span> <span class="text-zinc-200"> </span></div> <div class="flex items-center justify-between"><span class="text-zinc-400">Name</span> <span class="text-zinc-200"> </span></div> <div class="flex items-center justify-between"><span class="text-zinc-400">Tenant ID</span> <span class="text-zinc-400 font-mono text-xs"> </span></div></div>',1),De=g('<div class="bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 px-3 py-2 rounded-lg text-sm mb-4"> </div>'),Ee=g('<h3 class="font-semibold mb-1">Bring your own database</h3> <p class="text-sm text-zinc-400 mb-4">Connect your own Turso/LibSQL database for full data ownership.</p> <!> <form class="space-y-3"><!> <!> <!></form>',1),Se=g('<div class="bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 px-3 py-2 rounded-lg text-sm mb-4"> </div>'),Te=g('<h3 class="font-semibold mb-1">Webhook notifications</h3> <p class="text-sm text-zinc-400 mb-4">Receive HTTP POST notifications for memory events (new learnings, decisions, alerts).</p> <!> <form class="space-y-3"><!> <!> <!></form>',1),Pe=g('<h3 class="font-semibold mb-1">Export data</h3> <p class="text-sm text-zinc-400 mb-4">Download all your data in JSON format.</p> <!>',1),ze=g("<!> <!>",1),Le=g('<div class="space-y-4"><p class="text-sm text-zinc-400">This will permanently delete your account, all API keys, team data, and usage history. This action cannot be undone.</p> <!></div>'),Ue=g('<div class="max-w-4xl space-y-8"><!> <!> <!> <!> <!> <!> <div class="border border-red-500/20 rounded-xl p-6"><h3 class="font-semibold text-red-400 mb-1">Danger zone</h3> <p class="text-sm text-zinc-400 mb-4">Permanently delete your account and all associated data. This cannot be undone.</p> <!></div></div> <!>',1);function qe(ie,de){he(de,!0);const q=xe();let S=p(""),T=p(""),R=p(!1),P=p(""),z=p(""),h=p(""),O=p(!1),L=p(""),Y=p(!1),U=p(!1),C=p(!1),W=p(""),I=p(!1),B=p("");async function G(){try{const a=await D.getWebhookSettings();t(z,a.webhookUrl,!0),t(h,a.webhookSecret,!0),t(Y,!0)}catch{}}async function ce(){t(O,!0),t(L,"");try{await D.setWebhookSettings(e(z),e(h)),t(L,"Webhook configuration saved."),t(h,""),await G()}catch(a){t(L,a instanceof H?a.message:"Failed to save",!0)}finally{t(O,!1)}}ge(()=>{G()});async function ue(){t(R,!0),t(P,"");try{await D.setDatabase(e(S),e(T)),t(P,"Database configuration saved."),t(S,""),t(T,"")}catch(a){t(P,a instanceof H?a.message:"Failed to save",!0)}finally{t(R,!1)}}async function ve(){t(U,!0);try{const a=await D.exportData(),v=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),s=URL.createObjectURL(v),n=document.createElement("a");n.href=s,n.download=`muninn-export-${new Date().toISOString().split("T")[0]}.json`,n.click(),URL.revokeObjectURL(s)}catch(a){t(B,a instanceof H?a.message:"Export failed",!0)}finally{t(U,!1)}}async function pe(){t(I,!0);try{await D.deleteAccount(),D.logout()}catch(a){t(B,a instanceof H?a.message:"Failed to delete account",!0),t(I,!1)}}var K=Ue(),J=k(K),V=c(J);$e(V,{title:"Settings",description:"Manage your account and preferences."});var X=o(V,2);{var fe=a=>{var v=ke(),s=c(v,!0);u(v),A(()=>$(s,e(B))),d(a,v)};Q(X,a=>{e(B)&&a(fe)})}var Z=o(X,2);N(Z,{children:(a,v)=>{var s=we(),n=o(k(s),2),f=c(n),l=o(c(f),2),m=c(l,!0);u(l),u(f);var b=o(f,2),_=o(c(b),2),r=c(_,!0);u(_),u(b);var i=o(b,2),x=o(c(i),2),j=c(x,!0);u(x),u(i),u(n),A(()=>{var oe,se,ne;$(m,(oe=q.tenant)==null?void 0:oe.email),$(r,((se=q.tenant)==null?void 0:se.name)??"â€”"),$(j,(ne=q.tenant)==null?void 0:ne.id)}),d(a,s)},$$slots:{default:!0}});var ee=o(Z,2);N(ee,{children:(a,v)=>{var s=Ee(),n=o(k(s),4);{var f=r=>{var i=De(),x=c(i,!0);u(i),A(()=>$(x,e(P))),d(r,i)};Q(n,r=>{e(P)&&r(f)})}var l=o(n,2),m=c(l);M(m,{label:"Database URL",placeholder:"libsql://your-db.turso.io",get value(){return e(S)},set value(r){t(S,r,!0)}});var b=o(m,2);M(b,{type:"password",label:"Auth Token",placeholder:"Your Turso auth token",get value(){return e(T)},set value(r){t(T,r,!0)}});var _=o(b,2);{let r=F(()=>e(R)||!e(S)||!e(T));E(_,{type:"submit",variant:"secondary",get loading(){return e(R)},get disabled(){return e(r)},children:(i,x)=>{w();var j=y("Save configuration");d(i,j)},$$slots:{default:!0}})}u(l),le("submit",l,r=>{r.preventDefault(),ue()}),d(a,s)},$$slots:{default:!0}});var te=o(ee,2);N(te,{children:(a,v)=>{var s=Te(),n=o(k(s),4);{var f=r=>{var i=Se(),x=c(i,!0);u(i),A(()=>$(x,e(L))),d(r,i)};Q(n,r=>{e(L)&&r(f)})}var l=o(n,2),m=c(l);M(m,{label:"Webhook URL",placeholder:"https://your-server.com/webhook",get value(){return e(z)},set value(r){t(z,r,!0)}});var b=o(m,2);{let r=F(()=>e(Y)&&e(h)?e(h):"Shared secret for signature verification");M(b,{type:"password",label:"Webhook Secret",get placeholder(){return e(r)},get value(){return e(h)},set value(i){t(h,i,!0)}})}var _=o(b,2);{let r=F(()=>e(O)||!e(z)||!e(h));E(_,{type:"submit",variant:"secondary",get loading(){return e(O)},get disabled(){return e(r)},children:(i,x)=>{w();var j=y("Save webhook");d(i,j)},$$slots:{default:!0}})}u(l),le("submit",l,r=>{r.preventDefault(),ce()}),d(a,s)},$$slots:{default:!0}});var ae=o(te,2);N(ae,{children:(a,v)=>{var s=Pe(),n=o(k(s),4);E(n,{variant:"secondary",onclick:ve,get loading(){return e(U)},get disabled(){return e(U)},children:(f,l)=>{w();var m=y();A(()=>$(m,e(U)?"Exporting...":"Export data")),d(f,m)},$$slots:{default:!0}}),d(a,s)},$$slots:{default:!0}});var re=o(ae,2),me=o(c(re),4);E(me,{variant:"danger",onclick:()=>{t(C,!0)},children:(a,v)=>{w();var s=y("Delete account");d(a,s)},$$slots:{default:!0}}),u(re),u(J);var be=o(J,2);ye(be,{get open(){return e(C)},onclose:()=>{t(C,!1),t(W,"")},title:"Delete account",actions:v=>{var s=ze(),n=k(s);E(n,{variant:"secondary",onclick:()=>{t(C,!1),t(W,"")},children:(l,m)=>{w();var b=y("Cancel");d(l,b)},$$slots:{default:!0}});var f=o(n,2);{let l=F(()=>e(W)!=="DELETE"||e(I));E(f,{variant:"danger",onclick:pe,get loading(){return e(I)},get disabled(){return e(l)},children:(m,b)=>{w();var _=y("Delete forever");d(m,_)},$$slots:{default:!0}})}d(v,s)},children:(v,s)=>{var n=Le(),f=o(c(n),2);M(f,{label:"Type DELETE to confirm",placeholder:"DELETE",get value(){return e(W)},set value(l){t(W,l,!0)}}),u(n),d(v,n)},$$slots:{actions:!0,default:!0}}),d(ie,K),_e()}export{qe as component};
