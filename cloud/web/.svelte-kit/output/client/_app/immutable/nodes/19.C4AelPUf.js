import{a as i,c as st,f,t as L}from"../chunks/BQbrFHdE.js";import{o as zt}from"../chunks/DKpGyjba.js";import{p as Mt,o as M,G as it,q as R,h as Pt,s as r,m,g as t,i as o,t as P,k as kt,j as s,n as I}from"../chunks/DEIXV2yr.js";import{d as At,e as Rt,s as b,a as U}from"../chunks/Bv3bKQ8S.js";import{i as q}from"../chunks/BKTWmeyc.js";import{e as nt,i as lt}from"../chunks/Bgl9SafJ.js";import{b as It,i as Et,s as Bt}from"../chunks/DkV04bLW.js";import{a as E,A as G}from"../chunks/CowlEwwk.js";import{b as vt}from"../chunks/Cbs5zNOM.js";import{H as Ct,C as Dt}from"../chunks/ARQSVmb3.js";import{D as dt}from"../chunks/BI-7B1J_.js";import{B as W}from"../chunks/BuIY9Rip.js";import{I as Ft}from"../chunks/Cuev1EoJ.js";import{B as ct}from"../chunks/EGcPkOJ4.js";import{M as Tt}from"../chunks/CrH9WQjl.js";var Lt=f('<div class="bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg text-sm"> </div>'),qt=f('<h3 class="font-semibold mb-4">Invite a team member</h3> <form class="flex gap-3"><div class="flex-1"><!></div> <select class="bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-zinc-300"><option>Member</option><option>Admin</option><option>Viewer</option></select> <!></form>',1),Ht=f('<span class="text-zinc-500 ml-2"> </span>'),Nt=f('<select class="bg-zinc-800 border border-zinc-700 rounded px-2 py-1 text-xs text-zinc-300"><option>Admin</option><option>Member</option><option>Viewer</option></select>'),Vt=f('<button class="text-sm text-red-400 hover:text-red-300">Remove</button>'),jt=f('<tr><td class="px-6 py-3"><div><span class="text-zinc-200"> </span> <!></div></td><td class="px-6 py-3"><!></td><td class="px-6 py-3 text-zinc-400"> </td><td class="px-6 py-3 text-right"><!></td></tr>'),Gt=f('<tr><td colspan="4" class="px-6 py-8 text-center text-zinc-500">No team members yet</td></tr>'),Ot=f('<tr><td class="px-6 py-3 text-zinc-300"> </td><td class="px-6 py-3"><!></td><td class="px-6 py-3 text-zinc-400"> </td><td class="px-6 py-3 text-right"><button class="text-sm text-red-400 hover:text-red-300">Cancel</button></td></tr>'),Jt=f('<h3 class="font-semibold">Pending invitations</h3> <!>',1),Kt=f("<!> <!>",1),Qt=f('<p class="text-sm text-zinc-400">Are you sure you want to remove <span class="text-zinc-200"> </span> from your team? They will lose access immediately.</p>'),St=f('<div class="max-w-4xl space-y-8"><!> <!> <!> <h3 class="font-semibold">Members</h3> <!> <!></div> <!>',1);function de(pt,mt){Mt(mt,!0);let X=M(it([])),O=M(it([])),H=M(""),J=M("member"),N=M(!1),$=M(""),y=M(null);zt(B);async function B(){try{const[e,n]=await Promise.all([E.getMembers(),E.getInvitations()]);m(X,e.members,!0),m(O,n.invitations,!0)}catch{}}async function ut(){m(N,!0),m($,"");try{await E.inviteMember(t(H),t(J)),m(H,""),await B()}catch(e){m($,e instanceof G?e.message:"Failed to send invite",!0)}finally{m(N,!1)}}async function _t(e,n){try{await E.updateMemberRole(e,n),await B()}catch(v){m($,v instanceof G?v.message:"Failed to update role",!0)}}async function ft(){if(t(y))try{await E.removeMember(t(y).id),m(y,null),await B()}catch(e){m($,e instanceof G?e.message:"Failed to remove member",!0)}}async function xt(e){try{await E.revokeInvitation(e),await B()}catch(n){m($,n instanceof G?n.message:"Failed to revoke invitation",!0)}}var Y=St(),K=R(Y),Z=o(K);Ct(Z,{title:"Team",description:"Manage your team members and invitations."});var tt=r(Z,2);{var gt=e=>{var n=Lt(),v=o(n,!0);s(n),P(()=>b(v,t($))),i(e,n)};q(tt,e=>{t($)&&e(gt)})}var et=r(tt,2);Dt(et,{children:(e,n)=>{var v=qt(),x=r(R(v),2),u=o(x),a=o(u);Ft(a,{type:"email",placeholder:"colleague@company.com",required:!0,get value(){return t(H)},set value(g){m(H,g,!0)}}),s(u);var d=r(u,2),c=o(d);c.value=c.__value="member";var _=r(c);_.value=_.__value="admin";var h=r(_);h.value=h.__value="viewer",s(d);var w=r(d,2);W(w,{type:"submit",get loading(){return t(N)},get disabled(){return t(N)},children:(g,k)=>{I();var z=L("Invite");i(g,z)},$$slots:{default:!0}}),s(x),Rt("submit",x,g=>{g.preventDefault(),ut()}),It(d,()=>t(J),g=>m(J,g)),i(e,v)},$$slots:{default:!0}});var at=r(et,4);dt(at,{columns:["Email","Role","Last login",""],children:(e,n)=>{var v=st(),x=R(v);nt(x,17,()=>t(X),lt,(u,a)=>{var d=jt(),c=o(d),_=o(c),h=o(_),w=o(h,!0);s(h);var g=r(h,2);{var k=p=>{var l=Ht(),A=o(l,!0);s(l),P(()=>b(A,t(a).name)),i(p,l)};q(g,p=>{t(a).name&&p(k)})}s(_),s(c);var z=r(c),C=o(z);{var Q=p=>{ct(p,{variant:"success",children:(l,A)=>{I();var T=L("Owner");i(l,T)},$$slots:{default:!0}})},V=p=>{var l=Nt(),A=o(l);A.value=A.__value="admin";var T=r(A);T.value=T.__value="member";var rt=r(T);rt.value=rt.__value="viewer",s(l);var ot;Et(l),P(()=>{ot!==(ot=t(a).role)&&(l.value=(l.__value=t(a).role)??"",Bt(l,t(a).role))}),U("change",l,wt=>_t(t(a).id,wt.target.value)),i(p,l)};q(C,p=>{t(a).role==="owner"?p(Q):p(V,!1)})}s(z);var D=r(z),F=o(D,!0);s(D);var S=r(D),j=o(S);{var $t=p=>{var l=Vt();U("click",l,()=>{m(y,t(a),!0)}),i(p,l)};q(j,p=>{t(a).role!=="owner"&&p($t)})}s(S),s(d),P(p=>{b(w,t(a).email),b(F,p)},[()=>t(a).lastLoginAt?vt(t(a).lastLoginAt):"Never"]),i(u,d)},u=>{var a=Gt();i(u,a)}),i(e,v)},$$slots:{default:!0}});var ht=r(at,2);{var yt=e=>{var n=Jt(),v=r(R(n),2);dt(v,{columns:["Email","Role","Expires",""],children:(x,u)=>{var a=st(),d=R(a);nt(d,17,()=>t(O).filter(c=>!c.acceptedAt),lt,(c,_)=>{var h=Ot(),w=o(h),g=o(w,!0);s(w);var k=r(w),z=o(k);ct(z,{children:(F,S)=>{I();var j=L();P(()=>b(j,t(_).role)),i(F,j)},$$slots:{default:!0}}),s(k);var C=r(k),Q=o(C,!0);s(C);var V=r(C),D=o(V);s(V),s(h),P(F=>{b(g,t(_).email),b(Q,F)},[()=>vt(t(_).expiresAt)]),U("click",D,()=>xt(t(_).id)),i(c,h)}),i(x,a)},$$slots:{default:!0}}),i(e,n)};q(ht,e=>{t(O).length>0&&e(yt)})}s(K);var bt=r(K,2);{const e=v=>{var x=Kt(),u=R(x);W(u,{variant:"secondary",onclick:()=>{m(y,null)},children:(d,c)=>{I();var _=L("Cancel");i(d,_)},$$slots:{default:!0}});var a=r(u,2);W(a,{variant:"danger",onclick:ft,children:(d,c)=>{I();var _=L("Remove");i(d,_)},$$slots:{default:!0}}),i(v,x)};let n=kt(()=>t(y)!==null);Tt(bt,{get open(){return t(n)},onclose:()=>{m(y,null)},title:"Remove team member",actions:e,children:(v,x)=>{var u=Qt(),a=r(o(u)),d=o(a,!0);s(a),I(),s(u),P(()=>{var c;return b(d,(c=t(y))==null?void 0:c.email)}),i(v,u)},$$slots:{actions:!0,default:!0}})}i(pt,Y),Pt()}At(["change","click"]);export{de as component};
