import{a as d,f as x,t as T}from"../chunks/Dp4zGy6Y.js";import{p as ie,o as k,h as de,s as r,j as c,t as U,k as a,g as t,l as u,n as z,F as X,m as f}from"../chunks/BJmdqduM.js";import{e as ce,s as g}from"../chunks/9hSCU5Uy.js";import{i as Z}from"../chunks/eWemM8hH.js";import{a as C,A as R}from"../chunks/CObeKhF_.js";import{g as ue}from"../chunks/CxK7HfGX.js";import{H as ve,C as B}from"../chunks/Do8S-cRJ.js";import{B as P}from"../chunks/C46VhHkI.js";import{I as F}from"../chunks/D_U8r58x.js";import{M as pe}from"../chunks/CQF6rH2y.js";import"../chunks/C-eedgcY.js";var me=x('<div class="bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg text-sm"> </div>'),fe=x('<h3 class="font-semibold mb-4">Account</h3> <div class="space-y-3 text-sm"><div class="flex items-center justify-between"><span class="text-zinc-400">Email</span> <span class="text-zinc-200"> </span></div> <div class="flex items-center justify-between"><span class="text-zinc-400">Name</span> <span class="text-zinc-200"> </span></div> <div class="flex items-center justify-between"><span class="text-zinc-400">Tenant ID</span> <span class="text-zinc-400 font-mono text-xs"> </span></div></div>',1),be=x('<div class="bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 px-3 py-2 rounded-lg text-sm mb-4"> </div>'),xe=x('<h3 class="font-semibold mb-1">Bring your own database</h3> <p class="text-sm text-zinc-400 mb-4">Connect your own Turso/LibSQL database for full data ownership.</p> <!> <form class="space-y-3"><!> <!> <!></form>',1),_e=x('<h3 class="font-semibold mb-1">Export data</h3> <p class="text-sm text-zinc-400 mb-4">Download all your data in JSON format.</p> <!>',1),ge=x("<!> <!>",1),$e=x('<div class="space-y-4"><p class="text-sm text-zinc-400">This will permanently delete your account, all API keys, team data, and usage history. This action cannot be undone.</p> <!></div>'),he=x('<div class="max-w-4xl space-y-8"><!> <!> <!> <!> <!> <div class="border border-red-500/20 rounded-xl p-6"><h3 class="font-semibold text-red-400 mb-1">Danger zone</h3> <p class="text-sm text-zinc-400 mb-4">Permanently delete your account and all associated data. This cannot be undone.</p> <!></div></div> <!>',1);function Se(ee,te){ie(te,!0);const I=ue();let $=f(""),h=f(""),L=f(!1),y=f(""),D=f(!1),j=f(!1),w=f(""),A=f(!1),S=f("");async function ae(){a(L,!0),a(y,"");try{await C.setDatabase(t($),t(h)),a(y,"Database configuration saved."),a($,""),a(h,"")}catch(e){a(y,e instanceof R?e.message:"Failed to save",!0)}finally{a(L,!1)}}async function re(){a(D,!0);try{const e=await C.exportData(),n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(n),o=document.createElement("a");o.href=s,o.download=`muninn-export-${new Date().toISOString().split("T")[0]}.json`,o.click(),URL.revokeObjectURL(s)}catch(e){a(S,e instanceof R?e.message:"Export failed",!0)}finally{a(D,!1)}}async function se(){a(A,!0);try{await C.deleteAccount(),C.logout()}catch(e){a(S,e instanceof R?e.message:"Failed to delete account",!0),a(A,!1)}}var N=he(),M=k(N),H=c(M);ve(H,{title:"Settings",description:"Manage your account and preferences."});var J=r(H,2);{var oe=e=>{var n=me(),s=c(n,!0);u(n),U(()=>g(s,t(S))),d(e,n)};Z(J,e=>{t(S)&&e(oe)})}var q=r(J,2);B(q,{children:(e,n)=>{var s=fe(),o=r(k(s),2),v=c(o),l=r(c(v),2),p=c(l,!0);u(l),u(v);var m=r(v,2),_=r(c(m),2),i=c(_,!0);u(_),u(m);var b=r(m,2),E=r(c(b),2),O=c(E,!0);u(E),u(b),u(o),U(()=>{var K,V,W;g(p,(K=I.tenant)==null?void 0:K.email),g(i,((V=I.tenant)==null?void 0:V.name)??"â€”"),g(O,(W=I.tenant)==null?void 0:W.id)}),d(e,s)},$$slots:{default:!0}});var Q=r(q,2);B(Q,{children:(e,n)=>{var s=xe(),o=r(k(s),4);{var v=i=>{var b=be(),E=c(b,!0);u(b),U(()=>g(E,t(y))),d(i,b)};Z(o,i=>{t(y)&&i(v)})}var l=r(o,2),p=c(l);F(p,{label:"Database URL",placeholder:"libsql://your-db.turso.io",get value(){return t($)},set value(i){a($,i,!0)}});var m=r(p,2);F(m,{type:"password",label:"Auth Token",placeholder:"Your Turso auth token",get value(){return t(h)},set value(i){a(h,i,!0)}});var _=r(m,2);{let i=X(()=>t(L)||!t($)||!t(h));P(_,{type:"submit",variant:"secondary",get loading(){return t(L)},get disabled(){return t(i)},children:(b,E)=>{z();var O=T("Save configuration");d(b,O)},$$slots:{default:!0}})}u(l),ce("submit",l,i=>{i.preventDefault(),ae()}),d(e,s)},$$slots:{default:!0}});var Y=r(Q,2);B(Y,{children:(e,n)=>{var s=_e(),o=r(k(s),4);P(o,{variant:"secondary",onclick:re,get loading(){return t(D)},get disabled(){return t(D)},children:(v,l)=>{z();var p=T();U(()=>g(p,t(D)?"Exporting...":"Export data")),d(v,p)},$$slots:{default:!0}}),d(e,s)},$$slots:{default:!0}});var G=r(Y,2),ne=r(c(G),4);P(ne,{variant:"danger",onclick:()=>{a(j,!0)},children:(e,n)=>{z();var s=T("Delete account");d(e,s)},$$slots:{default:!0}}),u(G),u(M);var le=r(M,2);pe(le,{get open(){return t(j)},onclose:()=>{a(j,!1),a(w,"")},title:"Delete account",actions:n=>{var s=ge(),o=k(s);P(o,{variant:"secondary",onclick:()=>{a(j,!1),a(w,"")},children:(l,p)=>{z();var m=T("Cancel");d(l,m)},$$slots:{default:!0}});var v=r(o,2);{let l=X(()=>t(w)!=="DELETE"||t(A));P(v,{variant:"danger",onclick:se,get loading(){return t(A)},get disabled(){return t(l)},children:(p,m)=>{z();var _=T("Delete forever");d(p,_)},$$slots:{default:!0}})}d(n,s)},children:(n,s)=>{var o=$e(),v=r(c(o),2);F(v,{label:"Type DELETE to confirm",placeholder:"DELETE",get value(){return t(w)},set value(l){a(w,l,!0)}}),u(o),d(n,o)},$$slots:{actions:!0,default:!0}}),d(ee,N),de()}export{Se as component};
