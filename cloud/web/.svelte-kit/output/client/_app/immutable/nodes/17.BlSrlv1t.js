import{a as o,f as n,t as Ee}from"../chunks/BQbrFHdE.js";import{o as Ge}from"../chunks/DKpGyjba.js";import{p as Je,o as P,G as le,a as Ve,g as e,m as v,h as We,s,i,j as a,q as de,t as C,n as Ke,k as N}from"../chunks/DEIXV2yr.js";import{d as Qe,s as S,a as ce}from"../chunks/Bv3bKQ8S.js";import{i as g}from"../chunks/BKTWmeyc.js";import{e as Z,i as Ue}from"../chunks/Bgl9SafJ.js";import{s as Xe}from"../chunks/QSA7lv9p.js";import{s as Ye}from"../chunks/CH4Gho_O.js";import{i as Ze,s as et}from"../chunks/DkV04bLW.js";import{a as ee}from"../chunks/CowlEwwk.js";import{H as tt,C as ve}from"../chunks/ARQSVmb3.js";import{S as O}from"../chunks/CkPAyeN2.js";import{B as rt}from"../chunks/EGcPkOJ4.js";import{S as ue}from"../chunks/2BnSfrOL.js";var at=n('<div class="flex items-center justify-center py-12"><!></div>'),it=n('<div class="text-center py-12"><p class="text-zinc-400 text-lg mb-2">No projects found</p> <p class="text-zinc-500 text-sm">Connect Muninn to a project to see session history here.</p></div>'),ot=n("<option> </option>"),st=n('<div class="flex items-center justify-center py-12"><!></div>'),nt=n('<div class="grid grid-cols-2 lg:grid-cols-4 gap-4"><!> <!> <!> <!></div>'),lt=n('<div class="text-center py-12"><p class="text-zinc-400">No sessions recorded yet for this project.</p></div>'),dt=n('<div class="w-0.5 flex-1 bg-zinc-800 mt-1"></div>'),ct=n('<div><p class="text-xs uppercase tracking-wider text-zinc-500 mb-1">Outcome</p> <p class="text-sm text-zinc-300"> </p></div>'),vt=n('<div><p class="text-xs uppercase tracking-wider text-zinc-500 mb-1">Ended</p> <p class="text-sm text-zinc-400"> </p></div>'),ut=n('<span class="bg-zinc-800 px-2 py-0.5 rounded text-xs font-mono text-zinc-400"> </span>'),ft=n('<div><p class="text-xs uppercase tracking-wider text-zinc-500 mb-1">Files Touched</p> <div class="flex flex-wrap gap-1.5"></div></div>'),pt=n('<p class="text-sm text-zinc-500 italic">No additional details available.</p>'),_t=n('<div class="mt-4 pt-4 border-t border-zinc-800 space-y-3"><!> <!> <!> <!></div>'),mt=n('<button type="button" class="flex gap-5 text-left w-full group svelte-9x10y0"><div class="flex flex-col items-center w-5 shrink-0"><div class="w-3 h-3 rounded-full mt-5 shrink-0 timeline-dot svelte-9x10y0"></div> <!></div> <div><div class="flex items-center gap-3 mb-2 flex-wrap"><span class="font-semibold text-emerald-400 font-mono text-sm"> </span> <span class="text-zinc-500 text-xs"> </span> <!></div> <p class="text-zinc-300 text-sm"> </p> <!></div></button>'),xt=n('<div class="flex flex-col"></div>'),gt=n("<!> <!>",1),bt=n('<div><label for="project-select" class="block text-sm font-medium text-zinc-400 mb-2">Project</label> <select id="project-select" class="w-full max-w-xs bg-zinc-900 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-zinc-100 focus:outline-none focus:ring-2 focus:ring-emerald-500/40 focus:border-emerald-500"></select></div> <!>',1),ht=n('<div class="max-w-[900px] mx-auto space-y-8"><!> <!></div>');function Rt(fe,pe){Je(pe,!0);let D=P(le([])),b=P(null),H=P(le([])),w=P(null),te=P(!0),q=P(!1),M=P(null);Ge(async()=>{try{const t=await ee.getProjects();v(D,t.projects,!0),e(D).length>0&&v(b,e(D)[0].id,!0)}catch{}finally{v(te,!1)}}),Ve(()=>{if(e(b)===null)return;const t=e(b);v(q,!0),v(H,[],!0),v(w,null),v(M,null),Promise.all([ee.getProjectSessions(t,100),ee.getRoiMetrics(t)]).then(([c,$])=>{e(b)===t&&(v(H,c.sessions,!0),v(w,$,!0))}).catch(()=>{}).finally(()=>{e(b)===t&&v(q,!1)})});function re(t){return t===2?"#34d399":t===1?"#fbbf24":t===0?"#f87171":"#22d3ee"}function _e(t){return t.ended_at===null?"active":t.success===2?"success":t.success===1?"partial":t.success===0?"failed":"active"}function me(t){return t.ended_at===null?"default":t.success===2?"success":t.success===1?"warning":t.success===0?"danger":"default"}function ae(t){return new Date(t).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function E(t){if(!t.files_touched)return[];try{return JSON.parse(t.files_touched)}catch{return[]}}function xe(t){v(M,e(M)===t?null:t,!0)}function ge(t){const c=t.target;v(b,Number(c.value),!0)}var G=ht(),ie=i(G);tt(ie,{title:"Session Timeline",description:"Track your coding sessions and their outcomes"});var be=s(ie,2);{var he=t=>{var c=at(),$=i(c);ue($,{size:"lg"}),a(c),o(t,c)},ye=t=>{ve(t,{children:(c,$)=>{var h=it();o(c,h)},$$slots:{default:!0}})},ze=t=>{var c=bt(),$=de(c),h=s(i($),2);Z(h,21,()=>e(D),p=>p.id,(p,_)=>{var m=ot(),J=i(m,!0);a(m);var B={};C(()=>{S(J,e(_).name),B!==(B=e(_).id)&&(m.value=(m.__value=e(_).id)??"")}),o(p,m)}),a(h);var oe;Ze(h),a($);var we=s($,2);{var $e=p=>{var _=st(),m=i(_);ue(m,{size:"lg"}),a(_),o(p,_)},je=p=>{var _=gt(),m=de(_);{var J=x=>{var y=nt(),k=i(y);{let u=N(()=>String(e(w).contradictionsPrevented));O(k,{label:"Contradictions Prevented",get value(){return e(u)},subtitle:"This month"})}var r=s(k,2);{let u=N(()=>`${Math.round(e(w).contextHitRate*100)}%`);O(r,{label:"Context Hit Rate",get value(){return e(u)},subtitle:"Accuracy of context"})}var L=s(r,2);{let u=N(()=>String(e(w).learningsApplied));O(L,{label:"Learnings Applied",get value(){return e(u)},subtitle:"Reused knowledge"})}var T=s(L,2);{let u=N(()=>`${e(w).sessionsWithContext}/${e(w).totalSessions}`);O(T,{label:"Sessions with Context",get value(){return e(u)},subtitle:"Context-assisted"})}a(y),o(x,y)};g(m,x=>{e(w)&&x(J)})}var B=s(m,2);{var Se=x=>{ve(x,{children:(y,k)=>{var r=lt();o(y,r)},$$slots:{default:!0}})},ke=x=>{var y=xt();Z(y,23,()=>e(H),k=>k.id,(k,r,L)=>{var T=mt(),u=i(T),se=i(u),Pe=s(se,2);{var Ce=f=>{var z=dt();o(f,z)};g(Pe,f=>{e(L)<e(H).length-1&&f(Ce)})}a(u);var V=s(u,2),W=i(V),K=i(W),Ne=i(K);a(K);var Q=s(K,2),Te=i(Q,!0);a(Q);var De=s(Q,2);{let f=N(()=>me(e(r)));rt(De,{get variant(){return e(f)},children:(z,R)=>{Ke();var F=Ee();C(I=>S(F,I),[()=>_e(e(r))]),o(z,F)},$$slots:{default:!0}})}a(W);var U=s(W,2),He=i(U,!0);a(U);var Me=s(U,2);{var Re=f=>{var z=_t(),R=i(z);{var F=l=>{var d=ct(),j=s(i(d),2),A=i(j,!0);a(j),a(d),C(()=>S(A,e(r).outcome)),o(l,d)};g(R,l=>{e(r).outcome&&l(F)})}var I=s(R,2);{var Ae=l=>{var d=vt(),j=s(i(d),2),A=i(j,!0);a(j),a(d),C(X=>S(A,X),[()=>ae(e(r).ended_at)]),o(l,d)};g(I,l=>{e(r).ended_at&&l(Ae)})}var ne=s(I,2);{var Be=l=>{var d=ft(),j=s(i(d),2);Z(j,21,()=>E(e(r)),Ue,(A,X)=>{var Y=ut(),qe=i(Y,!0);a(Y),C(()=>S(qe,e(X))),o(A,Y)}),a(j),a(d),o(l,d)},Le=N(()=>E(e(r)).length>0);g(ne,l=>{e(Le)&&l(Be)})}var Fe=s(ne,2);{var Ie=l=>{var d=pt();o(l,d)},Oe=N(()=>!e(r).outcome&&E(e(r)).length===0&&!e(r).ended_at);g(Fe,l=>{e(Oe)&&l(Ie)})}a(z),o(f,z)};g(Me,f=>{e(M)===e(r).id&&f(Re)})}a(V),a(T),C((f,z,R)=>{Ye(se,`background: ${f??""}; box-shadow: 0 0 8px ${z??""}40;`),Xe(V,1,`flex-1 mb-3 bg-zinc-900 border rounded-xl p-4 transition-colors ${e(M)===e(r).id?"border-emerald-500/40":"border-zinc-800 group-hover:border-zinc-700"}`),S(Ne,`#${e(r).session_number??e(r).id??""}`),S(Te,R),S(He,e(r).goal??"No goal set")},[()=>re(e(r).success),()=>re(e(r).success),()=>ae(e(r).started_at)]),ce("click",T,()=>xe(e(r).id)),o(k,T)}),a(y),o(x,y)};g(B,x=>{e(H).length===0?x(Se):x(ke,!1)})}o(p,_)};g(we,p=>{e(q)?p($e):p(je,!1)})}C(()=>{oe!==(oe=e(b))&&(h.value=(h.__value=e(b))??"",et(h,e(b)))}),ce("change",h,ge),o(t,c)};g(be,t=>{e(te)?t(he):e(D).length===0?t(ye,1):t(ze,!1)})}a(G),o(fe,G),We()}Qe(["change","click"]);export{Rt as component};
