const g="https://api.muninn.pro";class s extends Error{constructor(o,i){super(i),this.status=o,this.name="ApiError"}}function c(){return localStorage.getItem("muninn_api_key")}function p(e){localStorage.setItem("muninn_api_key",e)}function d(){localStorage.removeItem("muninn_api_key")}async function t(e,o={}){const i=c(),r={"Content-Type":"application/json",...o.headers??{}};i&&(r.Authorization=`Bearer ${i}`);const a=await fetch(`${g}${e}`,{...o,headers:r});if(a.status===401)throw d(),window.location.href="/login",new s(401,"Unauthorized");if(!a.ok){const n=await a.json().catch(()=>({error:a.statusText}));throw new s(a.status,n.error??n.message??a.statusText)}if(a.status!==204)return a.json()}const m={async signup(e,o,i){const r=await t("/api/signup",{method:"POST",body:JSON.stringify({email:e,password:o,name:i})});return p(r.apiKey),r},async login(e,o){const i=await t("/api/login",{method:"POST",body:JSON.stringify({email:e,password:o})});return p(i.apiKey),i},logout(){d(),window.location.href="/login"},isAuthenticated(){return c()!==null},getAccount:()=>t("/api/account"),deleteAccount:()=>t("/api/account",{method:"DELETE"}),deleteData:()=>t("/api/delete-my-data",{method:"POST"}),exportData:()=>t("/api/export"),getKeys:()=>t("/api/keys"),createKey:e=>t("/api/keys",{method:"POST",body:JSON.stringify({name:e})}),revokeKey:e=>t(`/api/keys/${e}`,{method:"DELETE"}),getUsage:()=>t("/api/usage"),getMembers:()=>t("/api/team/members"),inviteMember:(e,o)=>t("/api/team/invite",{method:"POST",body:JSON.stringify({email:e,role:o})}),updateMemberRole:(e,o)=>t(`/api/team/members/${e}`,{method:"PATCH",body:JSON.stringify({role:o})}),removeMember:e=>t(`/api/team/members/${e}`,{method:"DELETE"}),getInvitations:()=>t("/api/team/invitations"),revokeInvitation:e=>t(`/api/team/invitations/${e}`,{method:"DELETE"}),createCheckout:()=>t("/api/billing/checkout",{method:"POST",body:JSON.stringify({plan:"pro"})}),openPortal:()=>t("/api/billing/portal",{method:"POST"}),setDatabase:(e,o)=>t("/api/database",{method:"PUT",body:JSON.stringify({tursoDbUrl:e,tursoAuthToken:o})}),getSsoConfig:()=>t("/api/sso/config"),updateSsoConfig:e=>t("/api/sso/config",{method:"PUT",body:JSON.stringify(e)}),deleteSsoConfig:()=>t("/api/sso/config",{method:"DELETE"}),testSso:()=>t("/api/sso/test",{method:"POST"}),getProjects:()=>t("/api/knowledge/projects"),getProjectMemory:e=>t(`/api/knowledge/projects/${e}/memory`),getProjectSessions:(e,o=50)=>t(`/api/knowledge/projects/${e}/sessions?limit=${o}`),getProjectGraph:e=>t(`/api/knowledge/projects/${e}/graph`),getHealthScore:e=>t(`/api/knowledge/health-score?project_id=${e}`),getRoiMetrics:e=>t(`/api/knowledge/metrics/roi?project_id=${e}`),searchKnowledge:(e,o)=>t(`/api/knowledge/projects/${e}/search?q=${encodeURIComponent(o)}`),getRiskAlerts:e=>t(`/api/knowledge/risk-alerts?projectId=${e}`),exportMemory:e=>t(`/api/knowledge/export/memory?projectId=${e}`),getProjectBriefing:(e,o=!1)=>t(`/api/knowledge/projects/${e}/briefing${o?"?refresh=true":""}`),getHealthHistory:(e,o=30)=>t(`/api/knowledge/health-score/history?project_id=${e}&limit=${o}`),getArchivedKnowledge:e=>t(`/api/knowledge/projects/${e}/archived`),restoreArchivedItem:(e,o)=>t(`/api/knowledge/projects/${e}/archived/${o}/restore`,{method:"POST"}),getWebhookSettings:()=>t("/api/settings/webhook"),setWebhookSettings:(e,o)=>t("/api/settings/webhook",{method:"PUT",body:JSON.stringify({webhookUrl:e,webhookSecret:o})})};export{s as A,m as a};
